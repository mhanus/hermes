*----
*  DEEP PENETRATION PROBLEM (DPP)
*  2-GROUP MACROSCOPIC CROSS SECTIONS
*  FIXED SOURCE PROBLEM
*  CARTESIAN 3 X 3 ASSEMBLY
*
*----
*  Define STRUCTURES and MODULES used
*----
LINKED_LIST
  DPPG TRACK MACRO SYS FLUX EDITION ;
SEQ_BINARY
  DPPGTRK ;
SEQ_ASCII
  Fig.ps ;
MODULE 
  GEO: EXCELT: MAC: ASM: FLU: EDI: PSP: DELETE: END: ;
*----
* Macroscopic XS
*----
MACRO := MAC: ::
  NGRO 2 NMIX 2 NIFI 0 ANIS 2 CTRA APOL
  READ INPUT 
  MIX 1   TOTAL 0.10108 0.108529 
          SCAT 2 1 0.015923
               2 2 0.012502 0.023434
               2 1 0.008976
               2 2 0.003914 0.009016  
          FIXE 0.006546 0.017701
  MIX 2   TOTAL 0.10108 0.108529 
          SCAT 2 1 0.015923
               2 2 0.012502 0.023434
               2 1 0.008976
               2 2 0.003914 0.009016  
  ;
*----
*  Geometry : DPPG 
*----
DPPG := GEO: :: CAR2D 2 2
  X- REFL X+ VOID Y- REFL Y+ VOID
  MESHX 0.0 65.0 133.0
  SPLITX 10 20
  MESHY 0.0 60.0 140.0
  SPLITY 10 20  
  MIX  1  2
       2  2
  ;
*----
*  Tracking : EXCELT - DPPG
*  Solution : FIXED SOURCE PROBLEM
*  Editing  : 1- FLUX AT X=66.7 CM
*             2- FLUX AT Y=3.00 CM
*             3- FLUX IN THE SOURCE AND MATERIAL AREAS
*----
TRACK DPPGTRK := EXCELT: DPPG ::
  EDIT 2
  TITLE 'DEEP PENETRATION PROBLEM'
  ANIS 2
  MAXR 1000 CUT 1.E-6 TRAK TSPC 24 24.0
  ;
SYS := ASM: MACRO TRACK DPPGTRK ::
  SKIP
  ;
FLUX := FLU: SYS MACRO TRACK :: 
  TYPE S THER 100 1.E-6 EXTE 100 1.E-6
  ;
EDITION := EDI: FLUX MACRO TRACK ::
  EDIT 1 SAVE
  MERGE REGION 
    0 0 0 0 0 0 0 0 0 0 1  0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 
    0 0 0 0 0 0 0 0 0 0 2  0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 
    0 0 0 0 0 0 0 0 0 0 3  0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 
    0 0 0 0 0 0 0 0 0 0 4  0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 
    0 0 0 0 0 0 0 0 0 0 5  0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 
    0 0 0 0 0 0 0 0 0 0 6  0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 
    0 0 0 0 0 0 0 0 0 0 7  0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 
    0 0 0 0 0 0 0 0 0 0 8  0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 
    0 0 0 0 0 0 0 0 0 0 9  0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 
    0 0 0 0 0 0 0 0 0 0 10 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 
    0 0 0 0 0 0 0 0 0 0 11 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 
    0 0 0 0 0 0 0 0 0 0 12 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 
    0 0 0 0 0 0 0 0 0 0 13 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 
    0 0 0 0 0 0 0 0 0 0 14 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 
    0 0 0 0 0 0 0 0 0 0 15 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 
    0 0 0 0 0 0 0 0 0 0 16 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 
    0 0 0 0 0 0 0 0 0 0 17 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 
    0 0 0 0 0 0 0 0 0 0 18 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 
    0 0 0 0 0 0 0 0 0 0 19 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 
    0 0 0 0 0 0 0 0 0 0 20 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 
    0 0 0 0 0 0 0 0 0 0 21 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 
    0 0 0 0 0 0 0 0 0 0 22 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 
    0 0 0 0 0 0 0 0 0 0 23 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 
    0 0 0 0 0 0 0 0 0 0 24 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 
    0 0 0 0 0 0 0 0 0 0 25 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 
    0 0 0 0 0 0 0 0 0 0 26 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 
    0 0 0 0 0 0 0 0 0 0 27 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 
    0 0 0 0 0 0 0 0 0 0 28 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 
    0 0 0 0 0 0 0 0 0 0 29 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 
    0 0 0 0 0 0 0 0 0 0 30 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0
  ;
EDITION := EDI: EDITION  FLUX  MACRO TRACK ::
  EDIT 1 SAVE
  MERGE REGION 
    1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25
    26 27 28 29 30 
    0 0 0 0 0 0 0 0 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
    0  0  0  0  0 
    0 0 0 0 0 0 0 0 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
    0  0  0  0  0 
    0 0 0 0 0 0 0 0 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
    0  0  0  0  0 
    0 0 0 0 0 0 0 0 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
    0  0  0  0  0 
    0 0 0 0 0 0 0 0 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
    0  0  0  0  0 
    0 0 0 0 0 0 0 0 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
    0  0  0  0  0 
    0 0 0 0 0 0 0 0 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
    0  0  0  0  0 
    0 0 0 0 0 0 0 0 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
    0  0  0  0  0 
    0 0 0 0 0 0 0 0 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
    0  0  0  0  0 
    0 0 0 0 0 0 0 0 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
    0  0  0  0  0 
    0 0 0 0 0 0 0 0 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
    0  0  0  0  0 
    0 0 0 0 0 0 0 0 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
    0  0  0  0  0 
    0 0 0 0 0 0 0 0 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
    0  0  0  0  0 
    0 0 0 0 0 0 0 0 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
    0  0  0  0  0 
    0 0 0 0 0 0 0 0 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
    0  0  0  0  0 
    0 0 0 0 0 0 0 0 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
    0  0  0  0  0 
    0 0 0 0 0 0 0 0 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
    0  0  0  0  0 
    0 0 0 0 0 0 0 0 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
    0  0  0  0  0 
    0 0 0 0 0 0 0 0 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
    0  0  0  0  0 
    0 0 0 0 0 0 0 0 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
    0  0  0  0  0 
    0 0 0 0 0 0 0 0 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
    0  0  0  0  0 
    0 0 0 0 0 0 0 0 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
    0  0  0  0  0 
    0 0 0 0 0 0 0 0 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
    0  0  0  0  0 
    0 0 0 0 0 0 0 0 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
    0  0  0  0  0 
    0 0 0 0 0 0 0 0 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
    0  0  0  0  0 
    0 0 0 0 0 0 0 0 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
    0  0  0  0  0 
    0 0 0 0 0 0 0 0 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
    0  0  0  0  0 
    0 0 0 0 0 0 0 0 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
    0  0  0  0  0 
    0 0 0 0 0 0 0 0 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0
    0  0  0  0  0 
  ;
EDITION := EDI: EDITION  FLUX  MACRO TRACK ::
  EDIT 1 SAVE
  TAKE MIX 1 2 
  ;
*----
*   Plotting
*----
Fig.ps := PSP: TRACK :: TYPE REGION ;
Fig.ps := PSP: Fig.ps TRACK :: TYPE MIXTURE ;
Fig.ps := PSP: Fig.ps TRACK FLUX :: TYPE FLUX ;
Fig.ps := PSP: Fig.ps TRACK FLUX :: TYPE MGFLUX ;
*----
*   Clean up
*----  
DPPGTRK  := DELETE: DPPGTRK  ;
END: ;
QUIT "LIST" .
